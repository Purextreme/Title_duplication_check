# 标题重复检查工具

一个用于检查Excel文件中标题重复词的工具。该工具可以自动识别标题中重复出现的单词，并在Excel中进行标记。

## 主要功能

- 支持多语言标题检查（英语、法语、西班牙语、意大利语、德语）
- 自动识别和过滤停用词（介词、冠词、连词等）
- 自动过滤度量单位（cm、kg、mm等）
- 支持重音字符处理
- 支持单复数形式识别（如table和tables被视为同一个词）
- 提供详细的日志记录

## 工作原理

1. 程序读取Excel文件中的标题列
2. 根据语言列（如果启用）确定每个标题的语言
3. 对标题进行分词处理
4. 过滤掉停用词（介词、冠词、连词等）和度量单位
5. 对英语和其他语言的单词进行单复数处理（如将"tables"识别为"table"）
6. 统计每个标题中重复出现的单词
7. 在Excel中添加新列，标记包含重复词的标题
8. 生成检查报告

## 安装依赖

```bash
pip install -r requirements.txt
```

## 配置说明

配置文件 `config.yaml` 包含以下设置：

### 检查设置
- `duplicate_threshold`: 重复次数阈值（默认为2，即单词出现超过2次视为重复）
- `detailed_logging`: 是否在日志中记录详细信息
- `case_sensitive`: 是否区分大小写（默认为false）
- `test_mode`: 测试模式（仅处理前N行）
- `test_rows`: 测试模式下处理的行数

### 列设置
- `title_column`: 标题列的列名（必填）
- `duplicate_column`: 重复词列的列名（必填）
- `enable_language_check`: 是否启用语言检测
- `language_column`: 语言列的列名
- `english_identifier`: 英语的标识符（在语言列中表示英语的值）

## 使用方法

1. 准备Excel文件，确保包含标题列
   - **重要**：Excel文件必须包含名为"title"的列（或在配置中指定的标题列名）
   - 程序会自动创建名为"重复词"的列（或在配置中指定的重复词列名）
   - 如果启用语言检测，确保文件中有语言列
   - 确保列名与配置文件中的设置一致

2. 根据需要修改 `config.yaml` 配置
   - 调整重复次数阈值
   - 设置是否启用语言检测
   - 配置列名

3. 运行程序
   ```bash
   python main.py
   ```

4. 在弹出的文件选择对话框中选择要处理的Excel文件

5. 程序处理完成后，将在原文件所在目录生成：
   - `marked_原文件名.xlsx`：包含检测结果的Excel文件
   - `check_report_时间戳.txt`：详细的检查报告

6. 查看结果：
   - 重复词将在Excel中以红色标记显示
   - 新增的"重复词"列会显示重复的单词及其出现次数

## 注意事项

- 程序默认不区分大小写
- 测试模式可用于快速验证配置是否正确
- 停用词表在`stopwords.csv`文件中，可以根据需要添加或修改
- 如果Excel文件中包含公式，建议先将公式转换为实际值（复制 -> 粘贴值）
- **列名要求**：程序会根据配置文件中指定的列名查找相应的列，如果找不到必要的列（如标题列），程序将无法正常运行 